<mxfile host="drawio-plugin" modified="2022-06-15T21:57:05.225Z" agent="5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36" etag="_1ysD78a6h5swzbjm2ab" version="14.7.4" type="embed"><diagram id="kgpKYQtTHZ0yAKxKKP6v" name="Page-1"><mxGraphModel dx="1118" dy="725" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="3nuBFxr9cyL0pnOWT2aG-1" value="Shard (nodes A,B,C)" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;whiteSpace=wrap;" parent="1" vertex="1"><mxGeometry x="170" y="115" width="100" height="450" as="geometry"/></mxCell><mxCell id="3nuBFxr9cyL0pnOWT2aG-2" value="" style="points=[];perimeter=orthogonalPerimeter;rounded=0;shadow=0;strokeWidth=1;" parent="3nuBFxr9cyL0pnOWT2aG-1" vertex="1"><mxGeometry x="45" y="70" width="10" height="380" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-10" value="ACK" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;entryX=1;entryY=0.092;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.531;exitDx=0;exitDy=0;exitPerimeter=0;" parent="3nuBFxr9cyL0pnOWT2aG-1" source="EhbencE6YgEs9aWXQ3aB-7" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="235" y="420.08000000000004" as="sourcePoint"/><mxPoint x="55" y="420.08000000000004" as="targetPoint"/></mxGeometry></mxCell><mxCell id="3nuBFxr9cyL0pnOWT2aG-5" value="Failover &#10;Coordinator X" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" parent="1" vertex="1"><mxGeometry x="340" y="80" width="100" height="240" as="geometry"/></mxCell><mxCell id="3nuBFxr9cyL0pnOWT2aG-6" value="" style="points=[];perimeter=orthogonalPerimeter;rounded=0;shadow=0;strokeWidth=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" vertex="1"><mxGeometry x="45" y="80" width="10" height="160" as="geometry"/></mxCell><mxCell id="3nuBFxr9cyL0pnOWT2aG-8" value="Heartbeat" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;exitX=1.4;exitY=0.026;exitDx=0;exitDy=0;exitPerimeter=0;entryX=-0.1;entryY=0.219;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="3nuBFxr9cyL0pnOWT2aG-2" target="3nuBFxr9cyL0pnOWT2aG-6" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="275" y="160" as="sourcePoint"/><mxPoint x="340" y="195" as="targetPoint"/></mxGeometry></mxCell><mxCell id="3nuBFxr9cyL0pnOWT2aG-9" value="ACK" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;entryX=1;entryY=0.092;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="3nuBFxr9cyL0pnOWT2aG-6" target="3nuBFxr9cyL0pnOWT2aG-2" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="240" y="200" as="sourcePoint"/><mxPoint x="180" y="220" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-2" value="Topology Director" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" parent="1" vertex="1"><mxGeometry x="570" y="220" width="100" height="240" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-3" value="" style="points=[];perimeter=orthogonalPerimeter;rounded=0;shadow=0;strokeWidth=1;" parent="EhbencE6YgEs9aWXQ3aB-2" vertex="1"><mxGeometry x="45" y="80" width="10" height="160" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-4" value="Heartbeat" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;entryX=-0.3;entryY=0.688;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="3nuBFxr9cyL0pnOWT2aG-2" target="3nuBFxr9cyL0pnOWT2aG-6" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="170" y="260" as="sourcePoint"/><mxPoint x="340" y="270" as="targetPoint"/><Array as="points"><mxPoint x="230" y="270"/></Array></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-5" value="MOVED" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;" parent="1" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="380" y="300" as="sourcePoint"/><mxPoint x="230" y="300" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-6" value="Failover&#10;Coordinator Y" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;" parent="1" vertex="1"><mxGeometry x="340" y="370" width="100" height="240" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-7" value="" style="points=[];perimeter=orthogonalPerimeter;rounded=0;shadow=0;strokeWidth=1;" parent="EhbencE6YgEs9aWXQ3aB-6" vertex="1"><mxGeometry x="45" y="80" width="10" height="160" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-8" value="TopologyState" style="endArrow=classic;html=1;" parent="1" edge="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="613" y="366" as="sourcePoint"/><mxPoint x="400" y="253" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-11" value="TopologyState" style="endArrow=classic;html=1;entryX=1.2;entryY=0.281;entryDx=0;entryDy=0;entryPerimeter=0;exitX=-0.1;exitY=0.681;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="EhbencE6YgEs9aWXQ3aB-3" target="EhbencE6YgEs9aWXQ3aB-7" edge="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="624" y="346.96000000000004" as="sourcePoint"/><mxPoint x="408" y="249.03999999999996" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-9" value="Heartbeat" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;entryX=0;entryY=0.375;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="EhbencE6YgEs9aWXQ3aB-7" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="230" y="510" as="sourcePoint"/><mxPoint x="380" y="510.12" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-12" value="&lt;font style=&quot;font-size: 16px&quot;&gt;Once FC X receives the update, it will refuse to handle any request from nodes A,B,C -- which means they will not be able to trigger a failover.&lt;br&gt;&lt;br&gt;If the nodes contact FC Y before it is aware of the new assignment they might get a MOVED -- but that would be ignored by them since the cluster topology has an epoch number.&lt;br&gt;(at worst - if the nodes are restarted - they would get MOVED twice)&lt;br&gt;&lt;br&gt;Transitioning across FCs resets the failover tick timers.&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="10" y="170" width="180" height="410" as="geometry"/></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-13" value="" style="endArrow=classic;html=1;entryX=1.4;entryY=0.275;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="EhbencE6YgEs9aWXQ3aB-3" edge="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="810" y="344" as="sourcePoint"/><mxPoint x="490" y="430" as="targetPoint"/></mxGeometry></mxCell><mxCell id="EhbencE6YgEs9aWXQ3aB-14" value="UpdateNodes" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="EhbencE6YgEs9aWXQ3aB-13" vertex="1" connectable="0"><mxGeometry x="0.0276" y="-4" relative="1" as="geometry"><mxPoint y="-10" as="offset"/></mxGeometry></mxCell><mxCell id="2" value="FailoverStatus" style="endArrow=classic;html=1;entryX=-0.5;entryY=0.25;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1.5;exitY=0.431;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="3nuBFxr9cyL0pnOWT2aG-6" target="EhbencE6YgEs9aWXQ3aB-3" edge="1"><mxGeometry x="-0.0198" y="15" width="50" height="50" relative="1" as="geometry"><mxPoint x="470" y="200" as="sourcePoint"/><mxPoint x="407" y="488.96000000000004" as="targetPoint"/><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="3" value="FailoverStatus" style="endArrow=classic;html=1;entryX=-0.1;entryY=0.544;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="EhbencE6YgEs9aWXQ3aB-3" edge="1"><mxGeometry x="-0.0198" y="15" width="50" height="50" relative="1" as="geometry"><mxPoint x="397" y="470" as="sourcePoint"/><mxPoint x="760" y="711.04" as="targetPoint"/><mxPoint as="offset"/></mxGeometry></mxCell></root></mxGraphModel></diagram></mxfile>